<ui:composition lang="#{localeBean.language}"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/lexUnitIndex.xhtml">
    <ui:define name="lexUnitOutput">
        <div class="ContainerIndent">
            <h:form id="form3">
                <p:tabView value="#{tabController.loadedLUs}" activeIndex="#{tabController.index}" var="lu" dynamic="false" cache="true" styleClass="tab-layout" id="tab-lu">
                    <p:ajax event="tabClose" listener="#{tabController.onTabLUClose}"/>
                    <p:tab title="#{lu.lightLU.name}" closable="true">
                        <div class="ContainerIndent">
                            <p:commandLink action="#{tabController.addFrame(lu.lightLU.frame)}" value="#{lu.lightLU.frame}" styleClass="horizontal"/>
                            <h:outputText value=".#{lu.lightLU.name}" styleClass="horizontal"/>
                            <p:dataList value="#{lexUnitController.lexUnitStatus(lu)}" var="status" type="definition" styleClass="horizontal">
                                <h:outputText styleClass="horizontal general-tooltip" value="[#{status.statusType.name}]" style="margin-left: 10px;"/>
                            </p:dataList>
                            <br/><br/>
                            <h:outputText value="#{lu.def}"/>
                        </div>
                        <p:commandButton value="All" style="display: #{lu.hasEl}"  styleClass="main-btn all-btn filter-btn" action="#{lexUnitController.addFilter(lu,'All')}" update="@(.allReal)" onclick="displayAll(#{lu.lightLU.id})"/> 
                        <p:commandButton value="Core Only" style="display: #{lu.hasCore}" styleClass="main-btn core-btn filter-btn" action="#{lexUnitController.addFilter(lu,'Core')}" update="@(.allReal)" onclick="displayCore(#{lu.lightLU.id})"/> 
                        <p:commandButton value="Non-Core Only" style="display: #{lu.hasNonCore}" styleClass="main-btn non-core-btn filter-btn" action="#{lexUnitController.addFilter(lu,'Non-Core')}" update="@(.allReal)" onclick="displayNonCore(#{lu.lightLU.id})"/> 
                        <div style="display: #{lu.displayCore}" id="core#{lu.lightLU.id}">
                            <p:dataTable var="element" styleClass="hide-column-names texalcenter" value="#{lu.feCoreRealizations}" emptyMessage=""> 
                                <p:column styleClass="element-column"> 
                                    <p:commandButton value="#{element.frameElement.name}" styleClass="core-btn filter-btn element-btn" action="#{lexUnitController.addFilter(lu,element.frameElement.name)}" update="@(.allReal)"/> 
                                </p:column> 
                                <p:column styleClass="real-column"> 
                                    <p:dataList var="var" value="#{element.patterns}" emptyMessage="" type="definition"> 
                                        <h:form>
                                            <p:commandButton process="@this" styleClass="horizontal filter-btn core-btn" value="#{var.valenceUnits.get(0).outputString()}" action="#{lexUnitController.addFilterReal(lu,element.frameElement, var.valenceUnits.get(0).outputString())}" update="@(.allReal)"/> 
                                        </h:form>
                                    </p:dataList> 
                                </p:column> 
                            </p:dataTable>
                        </div>
                        <div style="display: #{lu.displayNonCore}" id="non-core#{lu.lightLU.id}">
                            <p:dataTable var="element" styleClass="hide-column-names texalcenter" value="#{lu.feNonCoreRealizations}" emptyMessage=""> 
                                <p:column styleClass="element-column"> 
                                    <p:commandButton value="#{element.frameElement.name}" styleClass="filter-btn non-core-btn element-btn" action="#{lexUnitController.addFilter(lu, element.frameElement.name)}" update="@(.allReal)"/> 
                                </p:column> 
                                <p:column styleClass="real-column"> 
                                    <p:dataList var="var" value="#{element.patterns}" emptyMessage="" type="definition"> 
                                        <h:form>
                                            <p:commandButton process="@this" styleClass="horizontal filter-btn non-core-btn" value="#{var.valenceUnits.get(0).outputString()}" action="#{lexUnitController.addFilterReal(lu,element.frameElement, var.valenceUnits.get(0).outputString())}" update="@(.allReal)"/> 
                                        </h:form>
                                    </p:dataList> 
                                </p:column> 
                            </p:dataTable>
                        </div>
                        <div id="filter-selection" class="ContainerIndent">
                            <p:fieldset>
                                <p:dataList styleClass="allReal" var="elements" value="#{lexUnitController.getSelectedEl(lu)}" type="definition" emptyMessage="">
                                    <p:commandButton styleClass="horizontal selected-filter GreenButton" action="#{lexUnitController.removeFilter(lu, elements)}" value="#{elements}" icon="ui-icon-close" onclick="hideFilter(this)" update="@(.allReal)"/>
                                    <h:outputText styleClass="horizontal" rendered="#{lexUnitController.getSelectedEl(lu).indexOf(elements) != lexUnitController.getSelectedEl(lu).size() -1}" style="padding-top: 10px!important; margin: 3px" value="AND"/>
                                </p:dataList>
                            </p:fieldset>
                        </div>
                        <p:panel styleClass="tab-layout">
                            <div >
                                <p:dataTable id="patterns" styleClass="allReal" var="group" value="#{lexUnitController.getValencePatterns(lu)}" emptyMessage=""> 
                                    <p:column styleClass="valence-pattern-column"> 
                                        <p:dataTable var="realization" value="#{group.patterns}" tableStyle="width:auto" styleClass="valence-pattern" emptyMessage=""> 
                                            <p:column styleClass="total-vp-column"> 
                                                <f:facet name="header"> 
                                                    <p:commandLink value="#{group.totalOccurences}" update="@(.display-sent)" action="#{lexUnitController.totalGroup(lu,group)}" styleClass="total-vp" oncomplete="PF('dlg#{lu.lightLU.id}').show();"/> 
                                                </f:facet> 
                                                <p:commandLink id="imageBtn" value="[#{realization.annoSet.size()}]" action="#{lexUnitController.realPatterEntry(lu,realization)}" update="@(.display-sent)" oncomplete="PF('dlg#{lu.lightLU.id}').show();"/> 
                                            </p:column> 
                                            <p:columns var="fe" value="#{group.frameElements}" styleClass="list-fe-vp"> 
                                                <f:facet name="header"> 
                                                    <h:outputText value="#{fe.name}" styleClass="total-vp"/> 
                                                </f:facet> 
                                                <h:outputText value="#{realization.outputFE(fe)}" />  
                                            </p:columns> 
                                        </p:dataTable> 
                                    </p:column> 
                                </p:dataTable>
                            </div>
                        </p:panel>
                        <p:dialog widgetVar="dlg#{lu.lightLU.id}" id="wind" width="100%" height="300" resizable="false" position="left bottom" positionType="fixed" minimizable="true" draggable="false">
                            <f:facet name="header">
                                <p:commandLink value="#{text['clearAll']}" action="#{lexUnitController.clearAllSentences(lu)}" update="@(.display-sent)" style="font-size: smaller"/>
                            </f:facet>
                            <p:dataList id="output" value="#{lexUnitController.showAnnotation(lu)}" var="line" type="definition" emptyMessage="" styleClass="horizontal doc"> 
                                <p:commandLink value="x" styleClass="remove-link" update="@(.display-sent)" action="#{lexUnitController.removeSentence(lu, line)}"/>
                                <p:dataList type="definition" var="tag" value="#{line.elements}" styleClass="horizontal doc display-sent" >
                                    <p:panelGrid columns="1" styleClass="horizontal noborder texalcenter">
                                        <p:row>
                                            <p:dataList type="definition" var="word" value="#{tag.associated}" itemStyleClass="horizontal" styleClass="horizontal">
                                                <p:column style="text-align: center">
                                                    <h:outputText rendered="#{word.isValid()}" style="background-color: #{word.bkg};font-weight: bold;" value="#{word.text}"/>
                                                    <h:outputText rendered="#{!word.isValid()}" value="#{word.text}"/>
                                                </p:column>
                                            </p:dataList>
                                        </p:row>
                                        <p:row style="background-color: #f5f5f5">
                                            <p:lightBox style="border-top: solid 1px #{tag.color}; text-align: center">
                                                <h:outputLink value="#">
                                                    <h:outputText value="#{tag.value}" style="color: #{tag.color}"/>
                                                </h:outputLink>
                                                <f:facet name="inline">
                                                    <h:outputText value="#{tag.frameElement.definition}" escape="false"/>  
                                                </f:facet>
                                            </p:lightBox>
                                        </p:row>
                                    </p:panelGrid>
                                </p:dataList>
                            </p:dataList> 
                            <div class="EmptyBox40"/>
                        </p:dialog>
                    </p:tab>
                </p:tabView>
            </h:form>
        </div>

    </ui:define>
</ui:composition>